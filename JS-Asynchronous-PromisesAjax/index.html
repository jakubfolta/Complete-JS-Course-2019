<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Asynchronous JavaScript</title>
</head>
<body>
    <h1>Asynchronous JavaScript</h1>
    <script>
//		const second = () => {
//		   setTimeout( () => {
//		   console.log('Bye!');
//		   }, 2000);
//	   } 
//	   
//		const first = () => {
//		   console.log('Hello!');
//		   second();
//	   }
//	   
//		first();
//	   
//		function getRecipe() {
//			setTimeout( () => {
//				const recipeID= [198, 362, 7382];
//				console.log(recipeID);
//				
//				setTimeout( id => {
//					const recipe = {title: 'pizza', publisher: 'Q'};
//					console.log(`${id}: ${recipe.title}`);
//					
//					setTimeout( publisher => {
//						const recipe2 = {title: 'Spaghetti', publisher: 'John'};
//						console.log(recipe);
//						 
//					}, 1500, recipe.publisher);
//					
//				}, 1000, recipeID[2]);
//				
//			}, 1500);
//		}
//		
//		getRecipe();
		
		const getIDs = new Promise( (resolve, reject) => {
			setTimeout( () => {
				resolve([198, 362, 7382])
			}, 1500)
		})
		
		const getRecipe = recipeID => {
			return new Promise( (resolve, reject) => {
				setTimeout( ID => {
				const recipe = {title: 'pizza', publisher: 'Q'};
				resolve(`${ID}: ${recipe.title}`);
				}, 1500, recipeID)
			});
		}
		
		const getRelated = ( publisher => {
			return new Promise( (resolve, reject) => {
				setTimeout( pub => {
					const recipe = {title: 'Spaghetti', publisher: 'John'};
					resolve(`${pub}: ${recipe.title}`);
				}, 1500, publisher)
			})
		})
		
//		getIDs
//		.then( IDs => {
//			console.log(IDs);
//			return getRecipe(IDs[2])
//		})
//		.then( recipe => {
//			console.log(recipe);
//			return getRelated('John')
//		})
//		.then( pub => {
//			console.log(pub);
//		})
//		.catch( error => {
//			console.log(error);
//		});
		
		// async function always returns an promise we can consume
		async function getRecipesAW() { 
			const ID = await getIDs;
			console.log(ID);
			const recipe = await getRecipe(ID[2]);
			console.log(recipe);
			const related = await getRelated('John');
			console.log(related);
			
			return recipe;
		}
		
		getRecipesAW().then(rec => console.log(rec));
		
    </script>
</body>
</html>